<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Typing Test â€“ Apna Typing Master</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #eef2f7;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h2 { text-align:center; }
        select, button, textarea {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            font-size: 16px;
        }
        #passageBox {
            background: #f7f7f7;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            white-space: pre-wrap;
        }
        #typingArea {
            height: 150px;
            border: 2px solid #ccc;
            border-radius: 5px;
        }
        .correct { color: green; }
        .wrong { color: red; }
        .stats {
            margin-top: 20px;
            padding: 15px;
            background: #eef;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>English Typing Test</h2>

        <label>Select English Version:</label>
        <select id="engType">
            <option value="india">English (India)</option>
            <option value="us">English (US)</option>
            <option value="uk">English (UK)</option>
        </select>

        <label>Select Time:</label>
        <select id="timeSelect">
            <option value="60">1 Minute</option>
            <option value="120">2 Minutes</option>
            <option value="300">5 Minutes</option>
            <option value="600">10 Minutes</option>
            <option value="900">15 Minutes</option>
        </select>

        <label>Allow Backspace?</label>
        <select id="backspaceSelect">
            <option value="yes">Yes</option>
            <option value="no">No</option>
        </select>

        <label>Choose Passage:</label>
        <select id="passageSelect"></select>

        <div id="passageBox"></div>

        <textarea id="typingArea" placeholder="Start typing here..." disabled></textarea>

        <button id="startBtn">Start Typing</button>

        <div class="stats" id="resultBox" style="display:none;"></div>
    </div>

<script>
// English passages
const englishPassages = [
    "India is a land of diversity where people of various cultures and traditions live together.",
    "Success requires hard work, dedication, and continuous practice.",
    "Technology has transformed modern life, making tasks faster and easier."
];

window.onload = function() {
    let select = document.getElementById("passageSelect");
    englishPassages.forEach((p, i) => {
        let opt = document.createElement("option");
        opt.value = i;
        opt.textContent = "Passage " + (i+1);
        select.appendChild(opt);
    });

    select.addEventListener("change", ()=>{
        document.getElementById("passageBox").textContent = englishPassages[select.value];
    });

    document.getElementById("passageBox").textContent = englishPassages[0];
};

let timer;
let timeLeft;
let passage;
let typed = "";

function handleBackspace(e) {
    if (document.getElementById("backspaceSelect").value === "no") {
        if (e.key === "Backspace") e.preventDefault();
    }
}

document.getElementById("startBtn").onclick = function() {
    passage = document.getElementById("passageBox").textContent.trim();
    typed = "";

    timeLeft = parseInt(document.getElementById("timeSelect").value);
    document.getElementById("typingArea").value = "";
    document.getElementById("typingArea").disabled = false;
    document.getElementById("typingArea").focus();

    document.getElementById("typingArea").onkeydown = handleBackspace;
    document.getElementById("typingArea").oninput = checkTyping;

    timer = setInterval(updateTimer, 1000);
};

function updateTimer() {
    timeLeft--;
    if (timeLeft <= 0) {
        clearInterval(timer);
        finishTest();
    }
}

function checkTyping() {
    let userText = document.getElementById("typingArea").value;
    typed = userText;

    let resultHTML = "";

    for (let i = 0; i < userText.length; i++) {
        if (userText[i] === passage[i]) {
            resultHTML += `<span class='correct'>${userText[i]}</span>`;
        } else {
            resultHTML += `<span class='wrong'>${userText[i] || ''}</span>`;
        }
    }

    document.getElementById("passageBox").innerHTML = resultHTML + passage.slice(userText.length);
}

function finishTest() {
    let totalTyped = typed.length;
    let correct = 0;
    let errors = 0;

    for (let i=0; i<typed.length; i++) {
        if (typed[i] === passage[i]) correct++;
        else errors++;
    }

    let grossWPM = Math.round(totalTyped / 5 / (parseInt(document.getElementById("timeSelect").value)/60));
    let netWPM = Math.max(grossWPM - Math.round(errors / 5), 0);
    let accuracy = Math.round((correct / typed.length) * 100);

    document.getElementById("resultBox").style.display = "block";
    document.getElementById("resultBox").innerHTML = `
        <h3>Result</h3>
        Gross Speed: <b>${grossWPM}</b> WPM<br>
        Net Speed: <b>${netWPM}</b> WPM<br>
        Accuracy: <b>${accuracy}%</b><br>
        Errors: <b>${errors}</b>
    `;

    document.getElementById("typingArea").disabled = true;
}
</script>

</body>
</html>
